<section class="card p-8">
  <div class="flex items-end justify-between mb-6">
    <h1 class="text-3xl font-extrabold">Books</h1>

    <div class="flex gap-2">
      <%= link_to "Google Booksから検索", search_books_path, class: "btn bg-green-600 text-white hover:bg-green-700" %>
    </div>
  </div>

  <div class="flex flex-wrap gap-2 mb-4">
    <%= link_to "読了日（新）", books_path(sort: "read_on_desc", q: @search_params), class: "pill #{@sort == 'read_on_desc' ? 'bg-sky-500 text-white' : ''}" %>
    <%= link_to "読了日（古）", books_path(sort: "read_on_asc", q: @search_params), class: "pill #{@sort == 'read_on_asc' ? 'bg-sky-500 text-white' : ''}" %>
    <%= link_to "タイトル（昇順）", books_path(sort: "title_asc", q: @search_params), class: "pill #{@sort == 'title_asc' ? 'bg-sky-500 text-white' : ''}" %>
    <%= link_to "タイトル（降順）", books_path(sort: "title_desc", q: @search_params), class: "pill #{@sort == 'title_desc' ? 'bg-sky-500 text-white' : ''}" %>
  </div>

  <%= search_form_for @q, url: books_path, method: :get do |f| %>
    <%= hidden_field_tag :sort, @sort %>
    <div class="mt-4 flex gap-3">
      <%= f.search_field :title_or_authors_or_summary_cont, placeholder: "本を検索", class: "input" %>
      <%= f.submit "検索", class: "btn" %>
    </div>

    <div class="mt-4 flex flex-wrap gap-2">
      <% Tag.for_books.each do |tag| %>
        <label class="pill flex items-center gap-1">
          <%= f.check_box :tags_id_in, { multiple: true }, tag.id, nil %>
          <%= tag.name %>
        </label>
      <% end %>
    </div>
  <% end %>

  <div class="mt-8 grid gap-6 sm:grid-cols-3">
    <% @books.each do |book| %>
      <div class="rounded-2xl bg-slate-100 p-4 dark:bg-slate-900">
        <div class="h-48 rounded-xl bg-slate-300 grid place-items-center font-extrabold dark:bg-slate-700">
          表紙
        </div>

        <h2 class="mt-3 text-center font-bold"><%= book.title %></h2>

        <% if book.authors.present? %>
          <p class="mt-1 text-center text-sm text-slate-600 dark:text-slate-400">
            <%= book.authors %>
          </p>
        <% end %>

        <div class="mt-3 flex flex-wrap gap-2">
          <% book.tags.each do |tag| %>
            <span class="rounded-full bg-sky-200 px-2 py-1 text-xs font-semibold text-slate-900 dark:bg-sky-500 dark:text-white">
              <%= tag.name %>
            </span>
          <% end %>
        </div>

        <div class="mt-3">
          <%= link_to "詳細を見る", book_path(book), class: "btn w-full" %>
        </div>
      </div>
    <% end %>
  </div>
</section>
